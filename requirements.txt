# ==========================================
# Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø­Ø§Ù„Ø© Ø§Ù„ÙÙ„Ø§ØªØ± Ø§Ù„Ø°ÙƒÙŠ (Filter State Engine)
# ==========================================

# 1. ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ø¸Ø§Ù… Ø¨Ø°ÙƒØ§Ø¡ (Default Values Registry)
if "filters" not in st.session_state:
    st.session_state.filters = {
        "wilaya": "Ø§Ù„ÙƒÙ„",       # Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ø§Ù„Ø´Ø§Ù…Ù„Ø©
        "min_price": 0,        # Ø­Ø¯ Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø£Ø¯Ù†Ù‰
        "max_price": 500000,   # Ø­Ø¯ Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø£Ø¹Ù„Ù‰
        "search_query": "",    # Ù†Øµ Ø§Ù„Ø¨Ø­Ø«
        "sort_by": "Ø§Ù„Ø£ÙƒØ«Ø± Ø´Ø¹Ø¨ÙŠØ©", # Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ±ØªÙŠØ¨ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ
        "featured_only": False # Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù…Ù…ÙŠØ² ÙÙ‚Ø·
    }

# 2. ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚ÙŠÙ… Ø¯ÙˆÙ† Ø­Ø°Ù Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø®Ø±Ù‰ (Smart Update)
# Ù‡Ù†Ø§ Ù†Ù‚ÙˆÙ… Ø¨ØªØ¹ÙŠÙŠÙ† ÙˆÙ„Ø§ÙŠØ© Ø§Ù„Ø¬Ø²Ø§Ø¦Ø± (16) ÙƒÙ…Ø«Ø§Ù„ Ù…Ø¹ Ø§Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø¨Ù‚ÙŠØ© Ø§Ù„ÙÙ„Ø§ØªØ±
st.session_state.filters.update({
    "wilaya": "16",
    "last_updated": datetime.datetime.now().strftime("%H:%M:%S")
})

# 3. Ø£Ø¯Ø§Ø© Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø· Ø§Ù„ÙÙ„Ø§ØªØ± (Reset Tool)
def reset_filters():
    st.session_state.filters.update({
        "wilaya": "Ø§Ù„ÙƒÙ„",
        "min_price": 0,
        "search_query": "",
        "featured_only": False
    })
    st.rerun()

# 4. Ø¹Ø±Ø¶ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© ÙÙŠ Sidebar (Ù„Ù„Ù…Ø¯Ø±Ø§Ø¡ Ø£Ùˆ Ù„Ù„ØªØµØ­ÙŠØ­)
with st.sidebar:
    with st.expander("ğŸ¯ ØªÙØ¶ÙŠÙ„Ø§Øª Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø­Ø§Ù„ÙŠØ©"):
        st.write(st.session_state.filters)
        if st.button("â™»ï¸ Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø· Ø§Ù„ÙÙ„Ø§ØªØ±"):
            reset_filters()

